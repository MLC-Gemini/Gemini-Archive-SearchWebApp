// vim: set ft=groovy:
pipeline {
  agent any

  parameters {
    string( name: 'BUILDENV', defaultValue: 'CRMS-build', description: 'Artifactory: Build stage ID')
    string( name: 'DB_NAME',    defaultValue: '', description: 'Optional: Environment eg. CRMSD01')
  }

  environment {  // the following environment variables are required for aws cli to operate correclty.
    http_proxy = 'http://forwardproxy:3128'
    https_proxy = 'http://forwardproxy:3128'
    no_proxy = 'localhost,169.254.169.254,hip.ext.national.com.au'
    AWS_DEFAULT_REGION='ap-southeast-2'
    PATH = '/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin'
  }

   stages {
    stage('Bake CRMS EC2 image')
    { steps { sh "Gemini-Archive-SearchWebApp/bake_ec2_linux.sh" } }
  }
}
